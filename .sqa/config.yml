config:
  credentials:
      - id: orviz-github-basic
        username_var: GIT_USER
        password_var: GIT_PASSWORD
  project_repos:
    jenkins-pipeline-library:
      repo: https://github.com/indigo-dc/jenkins-pipeline-library
      branch: release/2.1.0

sqa_criteria:
  qc_doc:
    repos:
      jenkins-pipeline-library:
        container: sphinx
        commands:
          - ls -l /jepl
          - pip3 install -r /jepl/jenkins-pipeline-library/docs/requirements.txt
          - sphinx-multiversion /jepl/jenkins-pipeline-library/docs /jepl/jenkins-pipeline-library/docs/_build/html
          - cp /jepl/jenkins-pipeline-library/docs/assets/index.html /jepl/jenkins-pipeline-library/docs/_build/html/index.html
          - >
            env GIT_ASKPASS=/jepl/jenkins-pipeline-library/.git_credential_helper.sh
            git -C /jepl/jenkins-pipeline-library config user.name "Pablo Orviz"
            git -C /jepl/jenkins-pipeline-library config user.email "orviz@ifca.unican.es"
            ghp-import -n -p /jepl/jenkins-pipeline-library/docs/_build/html
